<!--
    taskpane.html
    Office Word 插件的主任务窗格 HTML 文件
    这是插件的入口 HTML 文件，负责加载 Office JavaScript API 和 React 应用
-->
<!doctype html>
<html lang="en" data-framework="typescript">

<head>
    <!-- 字符编码设置 -->
    <meta charset="UTF-8"/>
    <!-- 兼容性设置：强制使用 Edge 模式渲染，确保与 Office 环境兼容 -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <!-- 响应式视口设置 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- 页面标题 -->
    <title>Contoso Task Pane Add-in</title>

    <!-- Office JavaScript API 库 -->
    <!-- 这是 Office 插件开发的核心库，提供了与 Office 应用程序交互的 API -->
    <!-- 使用本地文件而不是 CDN，提高加载速度和离线开发支持 -->
    <script type="text/javascript" src="./lib/office.js"></script>
</head>

<body style="width: 100%; height: 100%; margin: 0; padding: 0;">
    <!-- React 应用的根容器 -->
    <!-- React 应用将挂载到这个 div 元素上 -->
    <div id="container"></div>

    <!--
        不支持的浏览器版本提示信息
        Fluent UI React v. 9 使用了现代 JavaScript 语法，不支持
        Trident (Internet Explorer) 或 EdgeHTML (Edge Legacy) 内核，
        因此此插件无法在使用了这些 webview 的 Office 版本中运行。
        下面的脚本会在检测到不支持的 webview 时显示此提示信息，并隐藏 React 容器。
    -->
    <div id="tridentmessage" style="display: none; padding: 10;">
        This add-in will not run in your version of Office. Please upgrade either to perpetual Office 2021 (or later)
        or to a Microsoft 365 account.
    </div>

    <!-- 浏览器兼容性检测脚本 -->
    <script>
        // 检测用户代理字符串，判断是否使用了不支持的浏览器内核
        // Trident 是 Internet Explorer 的内核
        // Edge 可能指 Edge Legacy (EdgeHTML 内核)
        if ((navigator.userAgent.indexOf("Trident") !== -1) || (navigator.userAgent.indexOf("Edge") !== -1)) {
            // 获取提示信息元素和正常容器元素
            var tridentMessage = document.getElementById("tridentmessage");
            var normalContainer = document.getElementById("container");

            // 显示不支持的浏览器提示信息
            tridentMessage.style.display = "block";

            // 隐藏 React 应用容器
            normalContainer.style.display = "none";
        }
    </script>
</body>
</html>
